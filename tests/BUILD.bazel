load("//bazel:fuzz_target.bzl", "java_fuzz_target_test")

java_fuzz_target_test(
    name = "LongStringFuzzer",
    srcs = [
        "src/test/java/com/example/LongStringFuzzer.java",
    ],
    data = ["src/test/java/com/example/LongStringFuzzerInput"],
    execute_crash_reproducer = True,
    fuzzer_args = [
        "$(rootpath src/test/java/com/example/LongStringFuzzerInput)",
    ],
    target_class = "com.example.LongStringFuzzer",
    verify_crash_input = False,
)

java_fuzz_target_test(
    name = "JpegImageParserAutofuzz",
    execute_crash_reproducer = True,
    fuzzer_args = [
        "--autofuzz=org.apache.commons.imaging.formats.jpeg.JpegImageParser::getBufferedImage",
        # Exit after the first finding for testing purposes.
        "--keep_going=1",
        "--autofuzz_ignore=java.lang.NullPointerException",
    ],
    runtime_deps = [
        "@maven//:org_apache_commons_commons_imaging",
    ],
)

java_fuzz_target_test(
    name = "QuickAsciiStringCompareFuzzer",
    srcs = ["src/test/java/com/example/QuickAsciiStringCompareFuzzer.java"],
    fuzzer_args = [
        "-runs=10000",
    ],
    target_class = "com.example.QuickAsciiStringCompareFuzzer",
)

java_fuzz_target_test(
    name = "QuickStringCompareFuzzer",
    srcs = ["src/test/java/com/example/QuickStringCompareFuzzer.java"],
    fuzzer_args = [
        "-runs=10000",
    ],
    target_class = "com.example.QuickStringCompareFuzzer",
)

java_fuzz_target_test(
    name = "QuickVariableStringLengthFuzzer",
    srcs = ["src/test/java/com/example/QuickVariableStringLengthFuzzer.java"],
    target_class = "com.example.QuickVariableStringLengthFuzzer",
)
