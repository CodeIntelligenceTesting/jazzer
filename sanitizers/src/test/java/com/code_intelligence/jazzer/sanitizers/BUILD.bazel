load("@contrib_rules_jvm//java:defs.bzl", "JUNIT5_DEPS", "java_junit5_test")

java_junit5_test(
    name = "FilePathTraversalTest",
    srcs = ["FilePathTraversalTest.java"],
    deps = JUNIT5_DEPS + [
        "//sanitizers/src/main/java/com/code_intelligence/jazzer/sanitizers:file_path_traversal",
        "@maven//:com_google_truth_truth",
        "@maven//:org_junit_jupiter_junit_jupiter_api",
        "@maven//:org_junit_jupiter_junit_jupiter_params",
    ],
)

java_junit5_test(
    name = "HookBindingSanityTest",
    srcs = ["HookBindingSanityTest.java"],
    deps = JUNIT5_DEPS + [
        "//sanitizers/src/main/java/com/code_intelligence/jazzer/sanitizers",
        "//sanitizers/src/main/java/com/code_intelligence/jazzer/sanitizers:constants",
        "//src/main/java/com/code_intelligence/jazzer/api:hooks",
        "@clojure_jar//jar",
        "@maven//:jakarta_el_jakarta_el_api",
        "@maven//:jakarta_validation_jakarta_validation_api",
        "@maven//:javax_el_javax_el_api",
        "@maven//:javax_persistence_javax_persistence_api",
        "@maven//:javax_validation_validation_api",
        "@maven//:org_apache_commons_commons_jexl",
        "@maven//:org_junit_jupiter_junit_jupiter_api",
        "@maven//:org_junit_jupiter_junit_jupiter_params",
        "@maven//:org_springframework_cloud_spring_cloud_function_context",
        "@maven//:org_springframework_cloud_spring_cloud_function_core",
    ],
)
